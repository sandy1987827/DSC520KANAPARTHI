---
title: "assignment_week9_kanaparthiVenkata"
author: "Venkata Kanaparthi"
date: "5/15/2021"
output: pdf_document
---


```{r include=TRUE, echo=FALSE}
library(ggm)
library(ggplot2)
library(readr)
library(pastecs)
library(readxl)
library(plyr)
library(dplyr)
library(magrittr)
library(purrr)
library(stringr)
library(QuantPsyc)
```

Set the working directory to the root of your DSC 520 directory

```{r include=TRUE, , echo=FALSE}
setwd('E:/MSDS-SEM2/DSC520/CodingAssignments/DSC520KANAPARTHI')
housing_df <- read_excel("data/week-6-housing.xlsx")
```

Housing Data

Work individually on this assignment. You are encouraged to collaborate on ideas and strategies pertinent to this assignment. Data for this assignment is focused on real estate transactions recorded from 1964 to 2016 and can be found in Housing.xlsx. Using your skills in statistical correlation, multiple regression, and R programming, you are interested in the following variables: Sale Price and several other possible predictors.

  If you worked with the Housing dataset in previous week â€“ you are in luck, you likely have already found any issues in the dataset and made the necessary transformations. If not, you will want to take some time looking at the data with all your new skills and identifying if you have any clean up that needs to happen.
  
## b.Complete the following:

1.) Explain any transformations or modifications you made to the dataset
  
Ans: Duplicates are deleted

2.) Create two variables; one that will contain the variables Sale Price and Square Foot of Lot (same variables used from previous assignment on simple regression) and one that will contain Sale Price and several additional predictors of your choice. Explain the basis for your additional predictor selections.

Ans: I chose the below 
  1.) square_feet_total_living : Total living areas increases the cost
  2.) building_grade: Quality of the material used in construction can increase the cost 
  3.) year_built : If it is recently built, price would be more because of the new technologies we use and facilities we provide


```{r include=TRUE}
spSfl_lm <-  lm( `Sale Price` ~ sq_ft_lot, data=housing_df)
spSfl_lm
spOtp_lm <-  lm( `Sale Price` ~ sq_ft_lot + square_feet_total_living + building_grade + year_built, data=housing_df)
spOtp_lm
```

3.) Execute a summary() function on two variables defined in the previous step to compare the model results. What are the R2 and Adjusted R2 statistics? Explain what these results tell you about the overall model. Did the inclusion of the additional predictors help explain any large variations found in Sale Price?

Ans:

With Single Predictor: Multiple R-squared:  0.01435,	Adjusted R-squared:  0.01428 
Multiple Predictors: Multiple R-squared:  0.2233,	Adjusted R-squared:  0.223

Large values of multiple R2 usually denotes the large correlation between the predicted and observed values. When the model was provided with additional predictors, it increased by 15 times of single predictor.

```{r include=TRUE}
summary(spSfl_lm)
```
```{r include=TRUE}
summary(spOtp_lm)
```

4.) Considering the parameters of the multiple regression model you have created. What are the standardized betas for each parameter and what do the values indicate?

Ans:

These values indicates that as sq_ft_lot increases by 1 standard deviation, sale price increases by 0.04017613 standard deviations
These values indicates that as square_feet_total_living increases by 1 standard deviation, sale price increases by 0.35375752 standard deviations
These values indicates that as building_grade increases by 1 standard deviation, sale price increases by 0.08655925 standard deviations
These values indicates that as year_built increases by 1 standard deviation, sale price increases by 0.10852388 standard deviations

square_feet_total_living and year_built plays a very significant role as per the above results

```{r include=TRUE}
lm.beta(spOtp_lm)
```

5.) Calculate the confidence intervals for the parameters in your model and explain what the results indicate.

Ans: The confidence intervals did not cross zero indicates that the estimate for the model are likely to represent the true population



```{r include=TRUE}
confint(spOtp_lm)
```

6.) Assess the improvement of the new model compared to your original model (simple regression model) by testing whether this change is significant by performing an analysis of variance.

```{r include=TRUE}
confint(spSfl_lm)
```

7.) Perform casewise diagnostics to identify outliers and/or influential cases, storing each function's output in a dataframe assigned to a unique variable name.

```{r include=TRUE}
housing_df$residuals <- resid(spSfl_lm)
housing_df$standardized.residuals <- rstandard(spSfl_lm)
housing_df$studentized.residuals <- rstudent(spSfl_lm)
housing_df$cooks.distance <- cooks.distance(spSfl_lm)
housing_df$dfbeta <- dfbeta(spSfl_lm)
housing_df$dffit <- dffits(spSfl_lm)
housing_df$levarage <- hatvalues(spSfl_lm)
housing_df$covariance.ratios <- covratio(spSfl_lm)
```

8.) Calculate the standardized residuals using the appropriate command, specifying those that are +-2, storing the results of large residuals in a variable you create.

```{r include=TRUE}
quest8_df <- housing_df$standardized.residuals > 2 | housing_df$standardized.residuals < -2
quest8_df
```

9.) Use the appropriate function to show the sum of large residuals.

```{r include=TRUE}
housing_df$large.residual <- housing_df$standardized.residuals > 2 | housing_df$standardized.residuals < -2
sum(housing_df$large.residual)
```

10.) Which specific variables have large residuals (only cases that evaluate as TRUE)?

```{r include=TRUE}
housing_df[housing_df$large.residual, c("Sale Price","sq_ft_lot","square_feet_total_living","building_grade" ,"year_built","standardized.residuals")]
```

11.) Investigate further by calculating the leverage, cooks distance, and covariance rations. Comment on all cases that are problematics.

Ans: None of the cooks distance is greater than 1 which indicates that these do not have any influence on the model

```{r include=TRUE}
housing_df[housing_df$large.residual, c("cooks.distance","levarage","covariance.ratios")]
```

12.) Perform the necessary calculations to assess the assumption of independence and state if the condition is met or not.

Ans: As D-W Statistic is less than 1 , it indicates positive correlation

```{r include=TRUE, echo=FALSE}
library(car)
dwt(spOtp_lm)
```

13.) Perform the necessary calculations to assess the assumption of no multicollinearity and state if the condition is met or not.

Ans: Regression may be biased because average VIF is greater than 1 (as per Bowerman and O'Connell, 1990)
```{r include=TRUE}
vif(spOtp_lm)
```
14.) Visually check the assumptions related to the residuals using the plot() and hist() functions. Summarize what each graph is informing you of and if any anomalies are present.
```{r include=TRUE}
hist(housing_df$studentized.residuals)
plot(housing_df$studentized.residuals)
```
15.) Overall, is this regression model unbiased? If an unbiased regression model, what does this tell us about the sample vs. the entire population model?

Ans: Yes, the model is unbiased. Looks like the sample represents the true population













